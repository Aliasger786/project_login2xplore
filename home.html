

<!DOCTYPE html>
<html>
<head>
	<title></title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap4.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://login2explore.com/jpdb/resources/js/0.0.4/jpdb-commons.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script>

  var ses=getJpdbSessionToken();

  
  
  status=isJpdbSessionTokenExists("90939243|-31949288213964405|90940099","Recruitment","HOST-REL");

  if(status === "200"){

  }
  else{
location.href="index.html";
  }
</script>
	 <script >
 	function chd()
 	{
 		return confirm("Are you sure you want to delete this record");
 	}
 </script>
	<style type="text/css">
  @import url('https://fonts.googleapis.com/css?family=Poppins:400,500,600,700&display=swap');
*{
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Poppins', sans-serif;
}
		#eb
{
  background-color: gold;
  color: white;
  width: 90px;
  font-size: 18px;
  height: 35px;
  border: none;
  border-radius: 5px;
}
 .alr {
        text-align: right;
        border: 0;
        margin-right: 90px;
      }
#db
{
  background-color: red;
  color: white;
  width: 90px;
  font-size: 18px;
  height: 35px;
    border: none;
  border-radius: 5px;
}
form .field{
  height: 50px;
  width: 100%;
  margin-top: 20px;
}
form .field input{
  height: 100%;
  width: 40%;
  outline: none;
  padding-left: 15px;
  border-radius: 5px;
  border: 1px solid lightgrey;
  border-bottom-width: 2px;
  font-size: 17px;
  transition: all 0.3s ease;
}
 form input:focus{
  border-color: #fc83bb;
  /* box-shadow: inset 0 0 3px #fb6aae; */
}
 form  input::placeholder{
  color: #999;
  transition: all 0.3s ease;
}
form input:focus::placeholder{
  color: #b3b3b3;
}
form input[type="submit"]{
  height: 100%;
  width: 41%;
  z-index: 1;

  position: relative;
  background: -webkit-linear-gradient(right, #a445b2, #fa4299, #a445b2, #fa4299);
  border: none;
  color: #fff;
  padding-left: 0;
  border-radius: 5px;
  font-size: 20px;
  font-weight: 500;
  cursor: pointer;
}
	</style>
</head>
<body style="margin: 0px; padding: 0px;">
	
  <nav class="navbar navbar-expand-lg navbar-light" style="background-color: #4169e1;">
    <a class="navbar-brand" href="#" style="color: white;">
        WELCOME
     </a>
    
     <div class="collapse navbar-collapse" id="navbarSupportedContent"></div>     
      
      <span class="nav-item dropdown" style="margin-right: 55px;font-size: 18px;">
        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="color: white;">
          Profile
        </a>
        <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">

          <a class="dropdown-item" href="index.html" onclick="return logout();"><i class="fa fa-sign-out"></i> Logout</a>
        
        </div>
    </span>
    </div>
    </div>
  </nav>


<p style="margin-left: 80px; margin-top: 30px; font-size: 25px; font-family: 'Poppins', sans-serif;">Candidate Details</p>
<div class="alr">

<button type="button" class="btn btn-primary" id="toggle">+Add</button> 
</div>

 <div id="third" style="text-align: center; display: none;">
<p style="font-size: 25px;"><b>Add Candidate</b></p>

<div id="result" style="text-align:center;"></div>
<form class="signup" method="post">
            <div class="field">
              <input type="text" placeholder="Name" name="name" id="name" required>
            </div>
<div class="field">
              <input type="email" placeholder="Email" name="em" id="em" required>
            </div>
<div class="field">
              <input type="phone" placeholder="phone no."name="ph" id="ph" required>
            </div>
            <div class="field">
              <input type="phone" placeholder="position" name="po" id="pos" required>
            </div>
<div class="field btn">
              <div class="btn-layer">
</div>
<input type="submit" value="Add" onclick="saveUser();">
            </div>
</form>
</div>

<div class="container" style="margin-top: 10px;" >
 
<table id="example" class="table table-striped table-bordered" width="100%" >
        <thead>
            <tr>
                <th>Id</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Position</th>
                <th style="background: royalblue; border: none;"></th>
                <th style="background: royalblue; border:none;"></th>
            </tr>
            
        </thead>
        <tbody id="myTable">
          
            
            </tbody>
          
    </table>
    
    </div>


<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js
"></script>
<script src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap4.min.js"></script>
<script src="app.js"></script>
<script type="text/javascript">
  const targetDiv = document.getElementById("third");
  targetDiv.style.display = "none";
const btn = document.getElementById("toggle");
btn.onclick = function () {
  if (targetDiv.style.display !== "none") {
    targetDiv.style.display = "none";
  } else {
    targetDiv.style.display = "block";
  }
};
</script>

<script>
function validateAndGetFormData() {

var name = $("#name").val();
if (name === "") {
alert("Name is required");

return "";
}

var email = $("#em").val();
if (email === "") {
alert("email is required");

return "";
}
var phone = $("#ph").val();

if (phone == "") {
alert("phone is required");

return "";
}

if (phone.length != 10) {
alert("invalid phone");

return "";
}

var pos = $("#pos").val();
if (pos === "") {
alert("position is required");

return "";
}



   var jsonStrObj = {
    id: "",
name: name,
email: email,
phone: phone,
position: pos
};

return JSON.stringify(jsonStrObj);



}

var getReq=createGETALLRecordRequest("90939243|-31949288213964405|90940099","Recruitment","USER-REL",1,10);

jQuery.ajaxSetup({async: false});
var resultObj = executeCommandAtGivenBaseUrl(getReq,"http://api.login2explore.com:5577", "/api/irl");
var tr= JSON.parse(resultObj.data).json_records;

var d1=document.getElementById('myTable')
jQuery.ajaxSetup({async: false});
var totalreq=createGET_RELATION_STATSRequest("90939243|-31949288213964405|90940099","Recruitment","USER-REL");
var resultObjj = executeCommandAtGivenBaseUrl(totalreq,"http://api.login2explore.com:5577", "/api/irl");
  var total=JSON.parse(resultObjj.data);
  
 
var count=0;
var j=0;
var total=total.record_count;
 for(var i=0;;){
  
  if (JSON.stringify(tr[i].record) === "null") 
  {  i+=1;  }
 else{
  
    var row ='<tr> <td>'+tr[i].record.id+ '</td><td>'+tr[i].record.name+' </td> <td>'+tr[i].record.email+' </td> <td>'+tr[i].record.phone+' </td> <td>'+tr[i].record.position+'</td><td><button type="button" class="btn btn-warning" onclick="edit('+tr[i].record.id+')">Edit</button></td><td><button type="button" class="btn btn-danger" onclick="deleteUser('+tr[i].record.id+')" >Delete</button></td></tr>';
 d1.innerHTML +=row;
 count +=1;
 i+=1;
 if(count==total){

  break;
 }
 else{

 }
 }

}
 
  
  jQuery.ajaxSetup({async: true});

function edit(tr1)
{
  var data = tr1;
 
  sessionStorage.setItem("email", data);
location.replace("update.html");
}

function saveUser() {
    var jsonStr = validateAndGetFormData();
    if (jsonStr === "") {
  return;
  }
  var putReqStr = createPUTRequest("90939243|-31949288213964405|90940099",
  jsonStr, "Recruitment","USER-REL");
  
  jQuery.ajaxSetup({async: false});
  var resultObj = executeCommandAtGivenBaseUrl(putReqStr,"http://api.login2explore.com:5577", "/api/iml");
  
  jQuery.ajaxSetup({async: true});
 
  gj=JSON.parse(jsonStr).email;
gj1=JSON.parse(jsonStr).password;
var jsonStrget = {
   email: gj
};

var jsget=JSON.stringify(jsonStrget);
  var findReqStr = createGET_BY_KEYRequest("90939243|-31949288213964405|90940099", "Recruitment","USER-REL",jsget);

jQuery.ajaxSetup({async: false});
var resultObj = executeCommandAtGivenBaseUrl(findReqStr,"http://api.login2explore.com:5577", "/api/irl");

var id=JSON.parse(resultObj.data).rec_no

uid=id.toString();

var jsonStrup = {
	 id: uid
  };

  var upjs=JSON.stringify(jsonStrup);

jQuery.ajaxSetup({async: true});

  var updateReq=createUPDATERecordRequest("90939243|-31949288213964405|90940099",upjs,"Recruitment","USER-REL",id);
  
  var resultObj = executeCommandAtGivenBaseUrl(updateReq,"http://api.login2explore.com:5577", "/api/iml");

  
  
  $("#name").val("")
  $("#em").val("");
  $("#ph").val("");
  $("#pos").val("");
  
  window.location.reload();

  }
  function resetForm() {
  $("#name").val("")
  $("#em").val("");
  $("#ph").val("");
  $("#po").val("");
  }
 
  function deleteUser(id){
    var result = confirm("Are you sure want to delete user "+id+" ?");
if (result) {
  var jsonStr = validateAndGetFormData3(id);
  
  var findReqStr = createGET_BY_KEYRequest("90939243|-31949288213964405|90940099", "Recruitment","USER-REL",jsonStr);

jQuery.ajaxSetup({async: false});

var resultObjjj = executeCommandAtGivenBaseUrl(findReqStr,"http://api.login2explore.com:5577", "/api/irl");
jQuery.ajaxSetup({async: true});

did=JSON.parse(resultObjjj.data).rec_no;

var deleteReq=createREMOVERecordRequest("90939243|-31949288213964405|90940099","Recruitment","USER-REL",did);
var test=JSON.parse(deleteReq);
test.jsonStr = {};
var dr=JSON.stringify(test)

jQuery.ajaxSetup({async: false});

var resultObjre = executeCommandAtGivenBaseUrl(dr,"http://api.login2explore.com:5577","/api/iml");

jQuery.ajaxSetup({async: true});

window.location.reload();
}
  }

  function validateAndGetFormData3(id) {
id=id.toString();
var jsonStrObj = {
id: id
};

return JSON.stringify(jsonStrObj);

}


function logout(){

  
 var log= removeSessionTokenFromJPDB("90939243|-31949288213964405|90940099","Recruitment","HOST-REL_session");

 



}
</script>

</body>
</html>